# Supabase è¨­ç½®æŒ‡å—

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å‰µå»º Supabase é …ç›®
1. å‰å¾€ [Supabase](https://supabase.com)
2. è¨»å†Šä¸¦å‰µå»ºæ–°é …ç›®
3. ç­‰å¾…é …ç›®åˆå§‹åŒ–å®Œæˆ

### 2. ç²å–é …ç›®é…ç½®
1. åœ¨é …ç›®å„€è¡¨æ¿ä¸­ï¼Œé»æ“Šå·¦å´çš„ "Settings" â†’ "API"
2. è¤‡è£½ä»¥ä¸‹ä¿¡æ¯ï¼š
   - **Project URL**: `https://your-project-id.supabase.co`
   - **Anon public key**: `eyJ...` (å…¬é–‹åŒ¿åå¯†é‘°)

### 3. æ›´æ–°ç’°å¢ƒè®Šé‡
åœ¨ `.env.local` æ–‡ä»¶ä¸­æ›´æ–°ä»¥ä¸‹è®Šé‡ï¼š

```env
# Supabase Configuration (ä¸»è¦æ•¸æ“šåº«)
VITE_SUPABASE_URL=https://your-project-id.supabase.co
VITE_SUPABASE_ANON_KEY=your_anon_public_key
```

### 4. å‰µå»ºæ•¸æ“šåº«è¡¨
1. åœ¨ Supabase å„€è¡¨æ¿ä¸­ï¼Œé»æ“Šå·¦å´çš„ "SQL Editor"
2. è¤‡è£½ `supabase-schema.sql` æ–‡ä»¶çš„å…§å®¹
3. è²¼ä¸Šä¸¦åŸ·è¡Œ SQL èªå¥

### 5. é…ç½®èªè­‰ (å¯é¸)
å¦‚æœéœ€è¦ç”¨æˆ¶èªè­‰åŠŸèƒ½ï¼š
1. é»æ“Šå·¦å´çš„ "Authentication" â†’ "Settings"
2. é…ç½® Google OAuth (ä½¿ç”¨ç¾æœ‰çš„ Google Client ID)
3. åœ¨ "Site URL" ä¸­æ·»åŠ ä½ çš„åŸŸå

## ğŸ“Š æ•¸æ“šåº«è¡¨çµæ§‹

### users (ç”¨æˆ¶è¡¨)
- `id`: UUID ä¸»éµ
- `email`: ç”¨æˆ¶éƒµç®± (å”¯ä¸€)
- `name`: ç”¨æˆ¶å§“å
- `picture`: é ­åƒ URL
- `created_at`, `updated_at`: æ™‚é–“æˆ³

### poops (ä¾¿ä¾¿è¨˜éŒ„è¡¨)
- `id`: å­—ç¬¦ä¸²ä¸»éµ
- `user_id`: ç”¨æˆ¶éƒµç®±
- `lat`, `lng`: ç¶“ç·¯åº¦
- `timestamp`: æ™‚é–“æˆ³
- `rating`: è©•åˆ† (1-5)
- `notes`: å‚™è¨»
- `photo`: ç…§ç‰‡ URL
- `privacy`: éš±ç§è¨­ç½® ('private', 'friends', 'public')
- `place_name`: åœ°é»åç¨±
- `custom_location`: è‡ªå®šç¾©ä½ç½®
- `address`: åœ°å€

### friends (å¥½å‹é—œä¿‚è¡¨)
- `id`: å­—ç¬¦ä¸²ä¸»éµ
- `user_id`: ç”¨æˆ¶éƒµç®±
- `friend_email`: å¥½å‹éƒµç®±
- `friend_name`: å¥½å‹å§“å
- `friend_picture`: å¥½å‹é ­åƒ
- `status`: ç‹€æ…‹ ('pending', 'accepted', 'rejected', 'blocked')
- `added_at`: æ·»åŠ æ™‚é–“

### friend_requests (å¥½å‹è«‹æ±‚è¡¨)
- `id`: å­—ç¬¦ä¸²ä¸»éµ
- `from_user_id`: ç™¼é€è€… ID
- `from_user_name`: ç™¼é€è€…å§“å
- `from_user_email`: ç™¼é€è€…éƒµç®±
- `from_user_picture`: ç™¼é€è€…é ­åƒ
- `to_user_email`: æ¥æ”¶è€…éƒµç®±
- `status`: ç‹€æ…‹ ('pending', 'accepted', 'rejected')
- `timestamp`: æ™‚é–“æˆ³

## ğŸ”’ å®‰å…¨æ€§é…ç½®

### Row Level Security (RLS)
æ‰€æœ‰è¡¨éƒ½å•Ÿç”¨äº†è¡Œç´šå®‰å…¨æ€§ï¼Œç¢ºä¿ï¼š
- ç”¨æˆ¶åªèƒ½æŸ¥çœ‹å’Œä¿®æ”¹è‡ªå·±çš„æ•¸æ“š
- å¥½å‹å¯ä»¥æŸ¥çœ‹å½¼æ­¤çš„ 'friends' éš±ç§ä¾¿ä¾¿
- æ‰€æœ‰äººéƒ½å¯ä»¥æŸ¥çœ‹ 'public' éš±ç§ä¾¿ä¾¿

### å¯¦æ™‚è¨‚é–±
å•Ÿç”¨äº†ä»¥ä¸‹è¡¨çš„å¯¦æ™‚è¨‚é–±ï¼š
- `poops`: ä¾¿ä¾¿è¨˜éŒ„è®ŠåŒ–
- `friend_requests`: å¥½å‹è«‹æ±‚è®ŠåŒ–
- `friends`: å¥½å‹é—œä¿‚è®ŠåŒ–

## ğŸ”„ æ•¸æ“šé·ç§»

### å¾ Firebase é·ç§» (å¯é¸)
å¦‚æœä½ æœ‰ç¾æœ‰çš„ Firebase æ•¸æ“šï¼Œå¯ä»¥ï¼š
1. å°å‡º Firebase æ•¸æ“š
2. è½‰æ›æ•¸æ“šæ ¼å¼
3. å°å…¥åˆ° Supabase

### å¾ localStorage é·ç§»
æ‡‰ç”¨æœƒè‡ªå‹•è™•ç† localStorage æ•¸æ“šï¼Œç„¡éœ€æ‰‹å‹•é·ç§»ã€‚

## ğŸ› ï¸ é–‹ç™¼å’Œæ¸¬è©¦

### æœ¬åœ°é–‹ç™¼
1. ç¢ºä¿ç’°å¢ƒè®Šé‡æ­£ç¢ºé…ç½®
2. é‹è¡Œ `npm run dev`
3. æ‡‰ç”¨æœƒè‡ªå‹•æª¢æ¸¬ä¸¦ä½¿ç”¨ Supabase

### æ¸¬è©¦é€£æ¥
æ‡‰ç”¨å•Ÿå‹•æ™‚æœƒåœ¨æ§åˆ¶å°é¡¯ç¤ºï¼š
```
âœ… Supabase connection successful
ğŸ“Š Current database provider: supabase
```

### å‚™é¸æ–¹æ¡ˆ
å¦‚æœ Supabase ä¸å¯ç”¨ï¼Œæ‡‰ç”¨æœƒè‡ªå‹•å›é€€åˆ°ï¼š
1. Firebase (å¦‚æœé…ç½®)
2. localStorage (é›¢ç·šæ¨¡å¼)

## ğŸ“ˆ ç›£æ§å’Œç¶­è­·

### æŸ¥çœ‹ä½¿ç”¨æƒ…æ³
åœ¨ Supabase å„€è¡¨æ¿ä¸­ï¼š
1. "Settings" â†’ "Usage" æŸ¥çœ‹ API ä½¿ç”¨é‡
2. "Database" â†’ "Tables" æŸ¥çœ‹æ•¸æ“š
3. "Logs" æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒ

### æ€§èƒ½å„ªåŒ–
- å·²å‰µå»ºå¿…è¦çš„æ•¸æ“šåº«ç´¢å¼•
- ä½¿ç”¨ RLS ç¢ºä¿æŸ¥è©¢æ•ˆç‡
- é™åˆ¶å…¬é–‹ä¾¿ä¾¿æŸ¥è©¢æ•¸é‡ (100 æ¢)

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ
1. **é€£æ¥å¤±æ•—**: æª¢æŸ¥ URL å’Œ API å¯†é‘°æ˜¯å¦æ­£ç¢º
2. **æ¬Šé™éŒ¯èª¤**: ç¢ºä¿ RLS æ”¿ç­–æ­£ç¢ºé…ç½®
3. **å¯¦æ™‚è¨‚é–±ä¸å·¥ä½œ**: æª¢æŸ¥è¡¨æ˜¯å¦æ·»åŠ åˆ° realtime publication

### èª¿è©¦æŠ€å·§
- æ‰“é–‹ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·æŸ¥çœ‹æ§åˆ¶å°æ—¥èªŒ
- åœ¨ Supabase å„€è¡¨æ¿æŸ¥çœ‹ API æ—¥èªŒ
- ä½¿ç”¨ Supabase çš„ SQL ç·¨è¼¯å™¨æ¸¬è©¦æŸ¥è©¢

## ğŸ¯ ä¸‹ä¸€æ­¥

è¨­ç½®å®Œæˆå¾Œï¼Œä½ çš„æ‡‰ç”¨å°‡ï¼š
- âœ… ä½¿ç”¨ Supabase ä½œç‚ºä¸»è¦æ•¸æ“šåº«
- âœ… æ”¯æŒå¯¦æ™‚æ•¸æ“šåŒæ­¥
- âœ… è‡ªå‹•å‚™é¸åˆ° Firebase æˆ– localStorage
- âœ… æä¾›æ›´å¥½çš„æ€§èƒ½å’Œæ“´å±•æ€§

äº«å—ä½¿ç”¨ Supabase çš„ä¾¿ä¾¿åœ°åœ–æ‡‰ç”¨å§ï¼ğŸ’©ğŸ—ºï¸